datasource db {
  url      = env("DB_URL")
  provider = "postgresql"
}

generator client {
  provider = "prisma-client-js"
}

enum AccountEnum {
  REVIEWED
  ACCEPTED
  REJECTED
  DELETED
}

enum Roles {
  ADMIN
  NORMAL
}

enum ScannedStatus {
  SUCCESSFULL
  FAILED
  UNDERREVIEW
}

enum ScannedFailedStatus {
  DONE
  UNDERREVIEW
}

model Warehouses {
  id              Int           @id @default(autoincrement())
  areaname        String      
  assletter       String
  locations       Location      @relation(fields: [locid], references: [locid])
  locid           String        
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @default(now())
}

model Location {
  id              Int             @id @default(autoincrement())
  locid           String          @unique @default(uuid())
  city            String      
  address         String
  assigneduser    User[]        
  Warehouses      Warehouses[]
  Scanned         Scans[]
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @default(now())
}

model User {
  id              String        @id @default(uuid())
  firstname       String   
  lastname        String
  email           String        @unique
  password        String
  account         AccountEnum   @default(REVIEWED)
  rejectedreason  String?
  location        Location      @relation(fields:[locid], references: [locid])
  locid           String        
  role            Roles         @default(NORMAL)
  scanProducts    Scans[]
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @default(now()) 
}

model Products {
  id              Int         @id @default(autoincrement())
  productId       String      @unique @default(uuid())
  barcode         String
  lotNo           String
  quantity        Int         @default(1)
  startingBid     Float
  title           String
  description     String
  category        String
  manufacturer    String
  consignor       Int?
  createdAt       DateTime    @default(now())
  updatedAt       DateTime    @default(now())
}

model Scans {
  id              Int                  @id @default(autoincrement())
  ScanId          String
  tag             String
  barcode         String
  auction         Auction              @relation(fields:[auctionId], references: [id])
  auctionId       String               @unique
  locations       Location             @relation(fields:[locid], references: [locid])
  locid           String
  status          ScannedStatus        @default(UNDERREVIEW)
  failedStatus    ScannedFailedStatus?
  rejectedreason  String?
  scannedUser     User                 @relation(fields:[scannedBy], references: [id])
  scannedBy       String
  tagexpireAt     DateTime             
  createdAt       DateTime             @default(now())
}

model ItemType {
  id              Int                   @id @default(autoincrement())
  name            String                @unique
}

model ScraperZip {
  id                  Int                   @id @default(autoincrement())
  filePath            String
  lastcsvgenerated    DateTime              @default(now())
  isNewUploaded       Boolean               @default(false)
  createdAt           DateTime              @default(now())
}

model Auction {
  id          String      @id @default(uuid())
  auctionType AuctionType @default(Auction1)
  scannedItem Scans[]
  startDate   DateTime
  startTime   DateTime
  endDate     DateTime
  endTime     DateTime
  startNumber Int
}

enum AuctionType {
  Auction1
  Auction2
}